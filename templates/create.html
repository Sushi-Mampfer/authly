<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Form</title>
</head>

<body>
    <label for="name">Name: </label>
    <input type="text" id="name">
    <form id="form">

    </form>
    <select id="select">
        <option value="">-- Select Field to add --</option>
        <option value="text">Text</option>
        <option value="email">Email</option>
        <option value="number">Number</option>
        <option value="multiple">Selection</option>
    </select>
    <button onclick="create()">Create</button>
    <script defer>
        var count = 0;
        const form = document.getElementById("form");
        const name = document.getElementById("name");
        const select = document.getElementById("select");
        select.addEventListener("change", (event) => {
            count++;
            const id = `field-${count}`;
            if (event.target.value == "") {
                return;
            } else if (event.target.value == "text") {
                const field = `
                    <div>
                        <p>Text</p>
                        <label for="${id}">Name:</label>
                        <input type="text" id="${id}">
                        <label for="maxlen">Max length</label>
                        <input type="number" id="maxlen">
                        <button onclick="delete_parrent(this, event)">Delete</button>
                    </div>
                `;
                form.innerHTML += field;
            } else if (event.target.value == "email") {
                const field = `
                    <div>
                        <p>Number</p>
                        <label for="${id}">Name:</label>
                        <input type="text" id="${id}">
                        <button onclick="delete_parrent(this, event)">Delete</button>
                    </div>
                `;
                form.innerHTML += field;
            } else if (event.target.value == "number") {
                const field = `
                    <div>
                        <p>Number</p>
                        <label for="${id}">Name:</label>
                        <input type="text" id="${id}">
                        <label for="max">Maximum</label>
                        <input type="number" id="max">
                        <label for="min">Minimum/label>
                        <input type="number" id="min">
                        <button onclick="delete_parrent(this, event)">Delete</button>
                    </div>
                `;
                form.innerHTML += field;
            } else if (event.target.value == "multiple") {
                const field = `
                    <div>
                        <p>Selection</p>
                        <label for="${id}">Name:</label>
                        <input type="text" id="${id}">
                        <ul>
                        </ul>
                        <input type="text">
                        <button onclick="add(this, event)">Add</button>
                        <button onclick="delete_parrent(this, event)">Delete</button>
                    </div>
                `;
                form.innerHTML += field;
            }
            event.target.selectedIndex = 0;
        });

        function delete_parrent(element, event) {
            event.preventDefault();
            element.parentElement.remove();
        }
        function add(element, event) {
            event.preventDefault();
            const input = element.parentElement.children[element.parentElement.children.length - 3];
            const list = element.parentElement.children[3];
            const field = `
                <li>
                    <p>${input.value}</p>
                    <button onclick="delete_parrent(this, event)">Delete</button>
                </li>
            `;
            list.innerHTML += field;
        }
        async function create() {
            let output = {
                "name": name.value,
                "fields": []
            };
            output.fields.append
            try {
                const response = await fetch(url, {
                    method: "POST",
                    headers: headers,
                    body: JSON.stringify(submission)
                });
                if (!response.ok) {
                    throw new Error(`Response status: ${response.status}`);
                }

                await response.json();
            } catch (error) {
                console.error(error.message);
            }
        }
    </script>
</body>

</html>